(()=>{function e(e){return document.querySelector(e)}var t,n=e("#begin"),l=e("#start"),i=e("#game"),s=e("#plane"),r=window.getComputedStyle(s),a=parseInt(r.width),h=parseInt(r.height),u=e("#myplane"),o=window.getComputedStyle(u),m=parseInt(o.width),y=parseInt(o.height),c=e("#layer"),p=null,g=null,d=null,P=null,f=null;function v(e){var t=e.offsetX,n=e.offsetY,l=a-m,i=h-y,s=t-m/2,r=n-y/2;s=s>l?l:s<0?0:s,r=r>i?i:r<0?0:r,u.style.left=s+"px",u.style.top=r+"px"}function b(){this.bulletWidth=6,this.bulletHeight=14,this.bulletX=0,this.bulletY=0,this.currentBullet=null,this.bulletSrc="./images/bullet.png"}b.prototype.createBullet=function(){this.currentBullet=document.createElement("img"),this.currentBullet.src=this.bulletSrc,this.currentBullet.style.position="absolute",this.currentBullet.style.zIndex=2,this.currentBullet.style.width=this.bulletWidth,this.currentBullet.style.height=this.bulletHeight;var e=parseInt(u.style.left),t=parseInt(u.style.top);this.bulletX=e+m/2-this.bulletWidth/2,this.bulletY=t-this.bulletHeight,this.currentBullet.style.left=this.bulletX+"px",this.currentBullet.style.top=this.bulletY+"px",i.appendChild(this.currentBullet)},b.prototype.moveBullet=function(e,t){this.bulletY-=2,this.bulletY<=0?(this.currentBullet.remove(),e.splice(t,1)):this.currentBullet.style.top=this.bulletY+"px"},b.prototype.shootEnemyPlane=function(e,t,n){for(var l=0;l<t.length;l++)if(this.bulletX>=t[l].enemyPlaneX-this.bulletWidth&&this.bulletX<=t[l].enemyPlaneX+t[l].enemyPlaneWidth&&this.bulletY>=t[l].enemyPlaneY-this.bulletHeight&&this.bulletY<=t[l].enemyPlaneY+t[l].enemyPlaneHeight){if(t[l].enemyPlaneBlood-=1,t[l].enemyPlaneBlood<=0){var s=document.createElement("img");s.src=t[l].enemyPlaneDieSrc,s.style.width=t[l].enemyPlaneWidth+"px",s.style.height=t[l].enemyPlaneHeight+"px",s.style.position="absolute",s.style.zIndex=3,s.style.left=t[l].enemyPlaneX+"px",s.style.top=t[l].enemyPlaneY+"px",t[l].currentEnemyPlane.remove(),t.splice(l,1),i.appendChild(s),setTimeout((function(){s.remove()}),400)}this.currentBullet.remove(),e.splice(n,1)}};var E,I=[],w=[{img:"./images/enemy1.png",dieImg:"./images/enemy1b.gif",width:34,height:24,blood:1},{img:"./images/enemy2.png",dieImg:"./images/enemy2b.gif",width:46,height:60,blood:5},{img:"./images/enemy3.png",dieImg:"./images/enemy3b.gif",width:110,height:164,blood:10}];function B(){var e,t=Math.random();e=t<=.5?w[0]:t<=.9?w[1]:w[2],this.enemyPlaneWidth=e.width,this.enemyPlaneHeight=e.height,this.enemyPlaneX=Math.random()*(a-this.enemyPlaneWidth),this.enemyPlaneY=-this.enemyPlaneHeight,this.enemyPlaneSrc=e.img,this.enemyPlaneDieSrc=e.dieImg,this.enemyPlaneBlood=e.blood,this.currentEnemyPlane=null}B.prototype.createEnemeyPlane=function(){this.currentEnemyPlane=document.createElement("img"),this.currentEnemyPlane.src=this.enemyPlaneSrc,this.currentEnemyPlane.style.width=this.enemyPlaneWidth+"px",this.currentEnemyPlane.style.height=this.enemyPlaneHeight+"px",this.currentEnemyPlane.style.position="absolute",this.currentEnemyPlane.style.zIndex=3,this.currentEnemyPlane.style.left=this.enemyPlaneX+"px",this.currentEnemyPlane.style.top=this.enemyPlaneY+"px",i.appendChild(this.currentEnemyPlane)},B.prototype.moveEnemeyPlane=function(e,t){this.enemyPlaneY+=2,this.enemyPlaneY>=h+this.enemyPlaneHeight?(this.currentEnemyPlane.remove(),e.splice(t,1)):this.currentEnemyPlane.style.top=this.enemyPlaneY+"px"};var x=[];window.onload=function(){var e,r,a,o;e=n,r="click",a=function(){var e;l.style.display="none",i.style.display="block",c.onmousemove=function(e){v(e)},c.onmouseenter=function(e){v(e)},e=document.getElementsByClassName("bg"),p=setInterval((function(){for(var t=0;t<e.length;t++){var n=parseInt(window.getComputedStyle(e[t]).top);(n+=2)>=h&&(n=-h),e[t].style.top=n+"px"}}),50),g=setInterval((function(){(t=new b).createBullet(),I.push(t)}),300),d=setInterval((function(){if(0!=I.length)for(var e=0;e<I.length;e++){if(I[e].moveBullet(I,e),null==I[e])return;I[e].shootEnemyPlane(I,x,e)}}),5),P=setInterval((function(){(E=new B).createEnemeyPlane(),x.push(E)}),1500),f=setInterval((function(){if(0!=x.length)for(var e=parseInt(u.style.left),t=parseInt(u.style.top),n=0;n<x.length;n++)if(x[n].moveEnemeyPlane(x,n),x[n].enemyPlaneX>=e-x[n].enemyPlaneWidth&&x[n].enemyPlaneX<=e+m&&x[n].enemyPlaneY>=t-x[n].enemyPlaneHeight&&x[n].enemyPlaneY<=t+y){u.querySelector("img").src="./images/planeb.gif",clearInterval(p),p=null,clearInterval(g),g=null,clearInterval(d),d=null,clearInterval(P),P=null,clearInterval(f),f=null,c.onmousemove=null,c.onmouseenter=null,console.log("��Ϸ����");var r=s.querySelectorAll("#game>img");for(n=0;n<r.length;n++)r[n].remove();x=[],I=[],setTimeout((function(){u.querySelector("img").src="./images/plane.gif",u.style.left="0px",u.style.top="607px",i.style.display="none",l.style.display="block"}),2e3)}}),20)},o=!!o,window.addEventListener?e.addEventListener(r,a,o):e.attachEvent("onclick",a)}})();